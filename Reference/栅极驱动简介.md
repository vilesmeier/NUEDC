
# Brief Introduction for Gate Driver ICs
本文主要介绍栅极驱动电路相关知识  
作者：电气23.3 毛晨镔  

**栅极驱动是电源题中最基础、最重要的一环。控制环路设计的再完美，没有驱动模块驱动发波，只会是成功参赛奖。所以强烈建议在比赛前做好功率模块的PCB，测试好功率拓扑能否正常发波。**

- [Brief Introduction for Gate Driver ICs](#brief-introduction-for-gate-driver-ics)
  - [参考资料](#参考资料)
  - [相关器件](#相关器件)
  - [什么是栅极驱动？](#什么是栅极驱动)
  - [为什么需要栅极驱动？](#为什么需要栅极驱动)
  - [栅极驱动选型参数](#栅极驱动选型参数)
  - [如何实现栅极驱动？](#如何实现栅极驱动)
    - [自举驱动：](#自举驱动)
    - [隔离电源驱动：](#隔离电源驱动)
    - [从驱动器到MOS管](#从驱动器到mos管)
  - [器件取值与选型](#器件取值与选型)
  - [栅极驱动布线技巧](#栅极驱动布线技巧)
  - [设计目标](#设计目标)
  - [常见GS波形与成因](#常见gs波形与成因)
  - [常见优化方法](#常见优化方法)
    - [RC/RCD吸收电路](#rcrcd吸收电路)
    - [MOS管选型与驱动优化](#mos管选型与驱动优化)

## 参考资料
[TI栅极驱动部分FAQs](https://e2e.ti.com/support/power-management-group/power-management/f/power-management-forum/1096147/faq-gate-driver-faq-frequently-asked-questions)

## 相关器件
[UCC21520](https://www.ti.com.cn/product/cn/UCC21520)  
[UCC21520器件手册](https://www.ti.com.cn/cn/lit/ds/symlink/ucc21520.pdf?ts=1751066847105)  

## 什么是栅极驱动？
栅极驱动，顾名思义，就是用于给MOS管的栅极提供可靠导通/可靠截止的Vgs电压。  
栅极驱动芯片接收来自单片机的PWM波，产生可以用于栅极驱动的高电压、大电流功率信号，等效于给单片机做功率放大。  
部分栅极驱动芯片（比如UCC21520），还具有通道互锁、硬件死区等功能，可以简化PWM发波逻辑  
通道互锁就是在两路PWM同时输入高电平有效时，向MOS管输出两个低电平，防止桥臂上两个MOS管同时导通导致电源瞬间短路。  
死区：在PWM跳变之间，人为添加的两个PWM同时低电平的时间。因为MOS管不是理想的，需要一定时间建立Vgs，所以MOS管有导通延迟、关断延迟。需要人为添加延迟时间，用于让导通的MOS管完全截止，然后再打开另一个MOS管。这段人为添加的时间就是死区，作用就是防止MOS直通导致电源短路。  
硬件死区指的是通过栅极驱动芯片内的死区模块产生PWM信号的死区，不用单片机产生特定时长的死区。  

## 为什么需要栅极驱动？
换言之，为什么不能通过单片机IO直接驱动MOS管？  
学过模电的同学应该都知道，NMOS需要Vgs>Vgsth（开启电压）之后才能导通，否则管子处于可变电阻区（放大区），这个区域内管子内阻相当大，但是又不是完全截止，导致发热量很大，分分钟炸管子。  
所以我们需要提供远大于Vgsth的电压，让MOS管可靠导通。对于小功率管，Vgsth可能是1V左右，这时候用单片机直接驱动是没有问题的。但是对于大功率管，Vgsth可能到2.8V（csd19534），这时候3.3V的单片机就不大够看了。而且向Vgs充电，等效于向Cgs充电，电容充电的尖峰电流可能瞬间烧掉只提供10mA的单片机。侥幸没烧单片机的话，那也会因为开关过程过长炸管子（**反正单片机和MOS管横竖得炸一个**）。  
除此之外，MOS管在导通时等效于mΩ级电阻，截止时等效于断路。所以只有在开通/截止时同时存在电压、电流，此时MOS管会消耗功率，这个功率会完全转化为热能。热量累计，温升过大照样炸。所以需要在短时间内快速、可靠的导通/截止MOS管。这个电流靠单片机的10mA是绝对不够的。

## 栅极驱动选型参数
功能上：  
隔离性能(高低压隔离？通道间隔离？)――最好通道间+高低压三隔离  
死区（自带死区？外部死区？死区固定or可调？）――最好是自带死区+可调  
内部通道互锁逻辑，能否解除互锁，PWM硬件关断  
参数上：  
拉灌电流（正比于驱动能力、MOS开关速率）――越大越好  
VCC/VDD范围（低压/高压电源范围）  
电平标准（CMOS/TTL/兼容，影响单片机需不需要电平转换）  

## 如何实现栅极驱动？
需要栅极驱动芯片实现，以及相关外围器件实现。  
栅极驱动芯片的主要厂商为英飞凌（IR系列）、国产屹晶微电子（EG系列）、德州仪器（UCC系列）。  
栅极驱动有一个关键的问题，绝大部分拓扑（H桥、FSBB）有源极浮空（Vs≠0，s极不接地）的MOS管。那这种MOS管该如何产生正的Vgs呢？难不成先搞个比直流电压还大的电源？（那我还要你干啥？）所以，为了解决这个问题，衍生出两大驱动拓扑：  
***自举驱动***、***隔离电源驱动***。  

### 自举驱动：

![全桥自举驱动](Pictures\image-2.png)

在上管完全导通时，SW节点电压等于母线电压，此时Vg需要高于母线电压，上管才能完全导通。  
这个电压是由Cboot利用电容两侧电压不变提供的。  
在下管导通时，通过自举二极管向Cboot充电。此时VDDA就获得了比VSSA高VDD的电压。下管截止，利用电容两侧电压不变，抬高VDDA电压，从而提供正Vgs。  
自举二极管用于在上管导通时隔离高压VDDA，防止高压直流母线电压窜入低压系统。  
这种驱动方式优点是**简单可靠**。  
缺点是**占空比没法做到0-100%**，因为Cboot需要时间充电，下管不能完全截止。  
这种拓扑因为简单可靠，所以应用极为广泛。  

### 隔离电源驱动：

![全桥隔离电源驱动](Pictures\image-3.png)

利用隔离电源，VDD的电压时刻高于VSS，此时可以做到**0-100%占空比开关**  
同时，高侧MOS自举电容电源来自隔离电源，所以也不需要自举二极管隔离高压直流。  
更常见的做法是，利用稳压管，将24V隔离电源输出分为+15V与-9V，引入负电压从而确保MOS管可靠截止。  
Ca1和Ca2为两个自举电容，Rz用于给稳压二极管限流，产生需要的稳压电流。  
**上管下管各用一个隔离电源**  
这种拓扑的优点是可以做到**0-100%占空比**  
缺点是**拓扑复杂**，效率极低，空载功率在8w左右，几乎无法满足电赛的效率需求  

### 从驱动器到MOS管
在驱动器的OUT引脚到MOS管的栅极之间，还有一些器件。  
Ron用于抑制振铃。PCB布线就会势必引入寄生电感，在高频开关+方波的高次谐波作用下，寄生电感与Cgs会产生振铃，导致Vgs瞬间突破20V，击穿MOS管的绝缘栅导致炸管、炸驱动。所以需要加大串联电阻，使振荡进入过阻尼状态，减少上升沿过冲。Ron可以**减弱过冲，但是会减慢栅极充电速度**。  

还有Rgs，Rgs作为下拉电阻，在OUT引脚不输出控制电平下，将栅极电压拉低至源极，提供确定电平减少误导通。同时为Qg提供泄放回路，防止栅极电荷累积导致击穿绝缘栅炸管。

MOS管的开关一般是**慢开快关**。关闭二极管的作用就是在关闭MOS管时短路栅极驱动电阻，使得MOS管快速关闭。

## 器件取值与选型
在一般情况下，相关器件取值如下：
Rboot、Roff取0Ω（不添加该电阻）  
Ron一般取1-10Ω，和驱动器、MOS管、PCB布线都有关，**实测取值，取不同的值，看Vgs过冲，选择没有过冲下最小电阻**。
自举电容Cboot**必须用MLCC**，**开关频率越小，Cboot越大，最小1uF**  
Cvdd**取值大于5-10倍Cboot**  
Rgs取10kΩ  
关闭二极管常用**开关二极管**，1N4148  
自举二极管**必须用肖特基/快恢复二极管，耐压要大于直流母线电压**，FR307/RS3M  
板载隔离电源可用B1224-3W  
剩余无源器件的数值在UCC21520的手册中都有介绍，一般PWM输入不需要滤波，故一般不焊接Cin、Rin  
所有低压电源引脚需要**1uF或者0.1uF电容去耦**  

## 栅极驱动布线技巧
由于MOS开关速度、电容充电特性，驱动电压的边沿有很大的dv/dt、di/dt。  
这要求驱动回路包围面积要尽可能的小。  
但是相较于主回路，驱动电路的dv/dt、di/dt较小，所以**优先保证主回路包围面积最小，其次保证驱动回路包围面积小**  
PCB布线尽可能粗  

## 设计目标
比较理想的栅极驱动波形：
![alt text](Pictures\image-4.png)

特征：慢开快关，上升沿没有过冲  

比较理想的逆变输出方波：  
![alt text](Pictures\21fe55976c61952ace7cc8eaf20414d.jpg)

特征：上升沿过冲小，无振铃，边沿跳变快。  

## 常见GS波形与成因





## 常见优化方法  
### RC/RCD吸收电路
在部分情况下，MOS在硬开关瞬间，会有极大的Vds振铃，如果振铃超过Vds的最大值，可能导致MOS击穿。  
但是为了振铃瞬间的尖峰电压，而去提高MOS的耐压等级，从成本上是不合算的。  
所以添加RCD吸收电路、RC吸收电路，可以吸收Vds尖峰。  
实际上应该从优化布线入手，优先优化PCB布线，减少寄生电容/寄生电感，从根本上解决问题  

### MOS管选型与驱动优化  
电赛的部分题目会对效率做出一定的要求，而MOS的损耗也是一大优化方向。  
MOS有几大常见的损耗：开关损耗/导通损耗/驱动损耗/反向回复损耗。  
**开关损耗**：MOS在导通/截止时，理想化认为没有功率耗散。在开关瞬间，同时存在电流、电压，MOS管会吸收功率减少开关损耗，可以从加速MOS管开关入手，可以减少Qg/增大驱动电流。  
**导通损耗**：实际的MOS在导通时，存在mΩ级别的电阻。减少导通损耗可以通过减少Rds（选MOS）、增加Vgs入手。增加Vgs时注意系统复杂度、MOS管的Vgs max。没有必要为了这个增加15V供电。  
**驱动损耗**：Gate Driver IC在驱动MOS管时，内部的PMOS/NMOS导通所耗费的功率。一般不做优化，优先保证Gate Driver IC 的性能。一般通过优化Rg，栅极驱动电阻实现。Rg过小无法抑制振铃，Rg过大降低系统效率，也需要实测取最优值。  
**反向回复损耗**：MOS管内存在寄生的反并联二极管，这是由MOS管结构决定的，无法避免。这个二极管称为体二极管/寄生二极管。实际上就是普通的整流二极管。减少这个损耗，可以通过外部并联肖特基二极管实现。  
与此同时，还涉及到Qg与Rds的权衡。Rds（on）越小，意味着Qg（Cgs）越大。导通损耗/开关损耗二者只可取其一。所以要根据实际的电流电压，计算开关损耗、导通损耗。  
